syntax = "proto3";

service Mafia {
    rpc ConnectToServer(ConnectToServerMessage) returns (stream ServerResponse) {}
    rpc GetConnectedUsers(GetConnectedUsersMessage) returns (GetConnectedUsersResponse) {}
}

message ConnectToServerMessage {
    string session_name = 1;
    string user_name = 2;
}

message GetConnectedUsersMessage {
    string session_name = 1;
}

message GetConnectedUsersResponse {
    repeated string user_names = 1;
}

message ServerResponse {
    oneof message_type {
        ErrorMessage error = 1;
        NewConnectionMessage new_connection = 2;
    }

    message ErrorMessage {
        ErrorType error_type = 1;

        enum ErrorType {
            USER_EXISTS = 0;
        }
    }
    
    message NewConnectionMessage {
        string new_user_name = 1;
        repeated string current_users = 2;
    }
}
